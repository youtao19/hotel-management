```sql
SELECT
    R.房间号 -- 我们要查询的是房间号
FROM
    房间表 R
WHERE
    R.房型ID = @指定房型ID -- 限定只查找属于这个房型的房间
    AND NOT EXISTS ( -- 使用 NOT EXISTS 子查询来排除掉那些“存在”冲突订单的房间
        SELECT 1
        FROM 订单表 O
        WHERE O.房间ID = R.房间ID -- 子查询关联：检查当前房间 (R.房间ID) 的订单
          AND O.订单状态 NOT IN ('已取消', '已退房', '已完成') -- 只考虑有效占用房间的订单状态
          AND @用户退房日期 > O.入住日期 -- 检查订单日期是否与用户日期重叠 (后半部分重叠)
          AND @用户入住日期 < O.退房日期  -- 检查订单日期是否与用户日期重叠 (前半部分重叠)
    );
```

